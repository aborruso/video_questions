# Product Requirements Document: QV - Video Question Answering CLI

## 1. Overview

**QV** is a command-line tool that allows users to ask questions about a YouTube video and receive concise answers generated by a Large Language Model (LLM). Instead of watching an entire video, users can use this tool to quickly extract specific information from the video's transcript. The tool is designed for developers, researchers, and students who need to process video content efficiently.

## 2. Goals and Objectives

*   **Primary Goal:** To enable users to get quick, text-based answers to questions about specific YouTube videos directly from their terminal.
*   **Key Objectives:**
    *   Eliminate the need to manually watch videos for specific information.
    *   Provide an efficient workflow by caching video transcripts to avoid redundant downloads.
    *   Offer flexibility through customizable options for language and output.
*   **Success Metric:** High user adoption and positive feedback regarding the accuracy and speed of the answers.

## 3. Target Audience

*   **Developers:** Who need to understand the content of a technical tutorial or presentation without watching it in its entirety.
*   **Researchers & Students:** Who are gathering information from video lectures, interviews, or documentaries and need to pinpoint specific topics quickly.
*   **Content Creators:** Who want to quickly review or reference content from other videos.

## 4. Features

### 4.1. Core Functionality: Question Answering
*   **Description:** The user provides a YouTube video URL and a question in natural language. The tool fetches the video's subtitles/transcript, sends it to an LLM along with the question, and displays the answer.
*   **User Story:** As a developer, I want to ask a question about a YouTube tutorial video so that I can get the answer without watching the full video.
*   **Acceptance Criteria:**
    *   Must accept a YouTube URL and a question as command-line arguments.
    *   Must output the LLM-generated answer to the standard output.

### 4.2. Transcript Handling
*   **Description:** The tool handles the fetching, processing, and caching of video transcripts.
*   **Features:**
    *   **Automatic Subtitle Download:** Uses `yt-dlp` to download the available text transcript for a given video.
    *   **Smart Language Detection:** It first attempts to download subtitles in the video's original language, falling back to English if the original is not available, and finally to any auto-generated captions.
    *   **Transcript Caching:** Caches downloaded transcripts locally to speed up subsequent queries for the same video. Cache expires after 60 days.
    *   **Save to File:** Allows the user to save the cleaned transcript to a specified file using the `-sub <filename>` flag.
    *   **Raw Transcript Output:** Provides an option (`--text-only`) to output the raw, cleaned transcript to the console without sending it to the LLM.

### 4.3. LLM Interaction & Customization
*   **Description:** Manages the interaction with the `llm` command-line tool and provides customization options.
*   **Features:**
    *   **Dynamic Prompt Generation:** Constructs a precise system prompt for the LLM, including the video's transcript and instructions.
    *   **Custom LLM Templates:** Supports custom prompt templates via the `-t <template>` flag, allowing users to leverage different models or prompt styles configured in their `llm` tool.
    *   **Language Localization:** Users can request the answer in a specific language using the `-p language <language>` flag (e.g., `-p language Italian`).

### 4.4. Input Validation and Error Handling
*   **Description:** Ensures the tool is robust and user-friendly by validating inputs and checking for dependencies.
*   **Features:**
    *   **Dependency Check:** Verifies that all required command-line tools (`yt-dlp`, `curl`, `llm`, `jq`) are installed before execution.
    *   **URL Validation:** Accepts standard (`youtube.com/watch?v=...`), short (`youtu.be/...`), and shorts (`youtube.com/shorts/...`) YouTube URLs and normalizes them.
    *   **Clear Usage Instructions:** Provides a detailed help message with examples if the user provides incorrect or insufficient arguments.

## 5. Command-Line Interface (CLI)

The tool is operated via the `qv` command.

### Basic Usage
```bash
qv <YouTube_URL> "<Your Question>"
```
**Example:**
```bash
qv "https://www.youtube.com/watch?v=dQw4w9WgXcQ" "What is the main theme of this song?"
```

### Options
*   **Get Answer in a Specific Language:**
    ```bash
    qv <URL> "<Question>" -p language <language_name>
    ```
    **Example:**
    ```bash
    qv "https://www.youtube.com/watch?v=dQw4w9WgXcQ" "What is this about?" -p language Spanish
    ```

*   **Use a Custom LLM Template:**
    ```bash
    qv <URL> "<Question>" -t <template_name>
    ```

*   **Save Transcript to File:**
    ```bash
    qv <URL> "<Question>" -sub subtitles.txt
    ```

*   **Get Raw Transcript Only:**
    ```bash
    qv <URL> --text-only
    ```

## 6. Out of Scope (Future Enhancements)

*   Support for other video platforms (e.g., Vimeo, Dailymotion).
*   A graphical user interface (GUI).
*   Batch processing of multiple videos.
*   Automatic video summarization without a specific question.
